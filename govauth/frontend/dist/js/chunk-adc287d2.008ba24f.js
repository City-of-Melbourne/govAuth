(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-adc287d2"],{"0bfb":function(e,s,t){"use strict";var n=t("cb7c");e.exports=function(){var e=n(this),s="";return e.global&&(s+="g"),e.ignoreCase&&(s+="i"),e.multiline&&(s+="m"),e.unicode&&(s+="u"),e.sticky&&(s+="y"),s}},3846:function(e,s,t){t("9e1e")&&"g"!=/./g.flags&&t("86cc").f(RegExp.prototype,"flags",{configurable:!0,get:t("0bfb")})},"6b54":function(e,s,t){"use strict";t("3846");var n=t("cb7c"),a=t("0bfb"),i=t("9e1e"),o="toString",r=/./[o],l=function(e){t("2aba")(RegExp.prototype,o,e,!0)};t("79e5")(function(){return"/a/b"!=r.call({source:"a",flags:"b"})})?l(function(){var e=n(this);return"/".concat(e.source,"/","flags"in e?e.flags:!i&&e instanceof RegExp?a.call(e):void 0)}):r.name!=o&&l(function(){return r.call(this)})},ba67:function(e,s,t){"use strict";t.r(s);var n=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",[t("section",[t("h1",{staticClass:"title"},[e._v("User")]),t("div",{staticClass:"columns is-mobile"},[t("div",{staticClass:"column is-8"},[t("b-autocomplete",{attrs:{rounded:"",data:e.filteredDataArray,field:"email",placeholder:"e.g. Email@email.com",icon:"magnify"},on:{select:function(s){return e.selected=s}}},[t("template",{slot:"empty"},[e._v("No users found")])],2)],1),t("div",{staticClass:"column is-4"},[t("div",{staticClass:"field is-grouped"},[t("div",{staticClass:"control"},[t("b-select",{attrs:{placeholder:"Select a role"},model:{value:e.model.role,callback:function(s){e.$set(e.model,"role",s)},expression:"model.role"}},e._l(e.roles,function(s){return t("option",{key:s.id,domProps:{value:s.id}},[e._v("\n                            "+e._s(s.name)+"\n                            ")])}))],1),t("div",{staticClass:"control"},[t("a",{staticClass:"button is-success",on:{click:function(s){e.addUser()}}},[e._m(0),t("span",[e._v("Add")])])])])])])]),t("br"),t("b-tabs",{attrs:{type:"is-toggle",expanded:""}},[t("b-tab-item",{attrs:{label:"Users",icon:"book"}},[t("b-table",{attrs:{data:e.usersData,paginated:"","per-page":"5","opened-detailed":e.defaultOpenedDetails,detailed:"","detail-key":"id"},on:{"details-open":function(s,t){return e.$toast.open("Expanded "+s.person.name)}},scopedSlots:e._u([{key:"default",fn:function(s){return[t("b-table-column",{attrs:{field:"person.name",label:"User",sortable:""}},[e._v("\n                        "+e._s(s.row.person.name)+"\n                    ")]),t("b-table-column",{attrs:{field:"person.email",label:"Email",sortable:""}},[e._v("\n                        "+e._s(s.row.person.email)+"\n                    ")]),t("b-table-column",{attrs:{field:"role.name",label:"Role",sortable:""}},[e._v("\n                        "+e._s(s.row.role.name)+"\n                    ")]),t("b-table-column",{attrs:{field:"date",label:"Joined date",sortable:"",centered:""}},[t("span",{staticClass:"tag is-success"},[e._v("\n                            "+e._s(new Date(s.row.date).toLocaleDateString())+"\n                        ")])])]}},{key:"detail",fn:function(s){return[t("article",{staticClass:"media"},[t("div",{staticClass:"media-content"},[t("div",{staticClass:"content"},[t("div",{staticClass:"columns is-desktop"},[t("div",{staticClass:"column"},[t("strong",[e._v(e._s(s.row.person.email)+" ("+e._s(s.row.person.name)+")")]),t("small",[e._v(" -> "+e._s(s.row.role.name))]),t("br")]),t("div",{staticClass:"column is-one-fifth"},[t("p",{staticClass:"control"},[t("a",{staticClass:"button is-danger",on:{click:function(t){e.deleteUser(s.row.id)}}},[t("span",{staticClass:"icon is-small"},[t("i",{staticClass:"fas fa-minus"})]),t("span",[e._v("Delete")])])])])])])])])]}}])})],1),t("b-tab-item",{attrs:{label:"Requests",icon:"exclamation"}},[t("b-table",{attrs:{data:e.usersReqData,paginated:"","per-page":"5","detail-key":"id"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("b-table-column",{attrs:{field:"user.name",label:"User",sortable:""}},[e._v("\n                                "+e._s(s.row.person.name)+"\n                            ")]),t("b-table-column",{attrs:{field:"user.email",label:"Email",sortable:""}},[e._v("\n                                    "+e._s(s.row.person.email)+"\n                                ")]),t("b-table-column",{attrs:{field:"user.role",label:"Role",sortable:""}},[e._v("\n                                "+e._s(s.row.role.name)+"\n                            ")]),t("b-table-column",{attrs:{field:"date",label:"Joined date",sortable:"",centered:""}},[t("span",{staticClass:"tag is-success"},[e._v("\n                                    "+e._s(new Date(s.row.date).toLocaleDateString())+"\n                                ")])]),t("b-table-column",{attrs:{field:"date",label:"Action",sortable:"",centered:""}},[t("a",{staticClass:"button is-success",on:{click:function(t){e.aceptUserRequest(s.row)}}},[t("span",{staticClass:"icon is-small"},[t("i",{staticClass:"fas fa-plus"})]),t("span",[e._v("Accept")])]),t("a",{staticClass:"button is-danger",on:{click:function(t){e.ignoreUserRequest(s.row.id)}}},[t("span",{staticClass:"icon is-small"},[t("i",{staticClass:"fas fa-minus"})]),t("span",[e._v("Ignore")])])])]}}])})],1)],1)],1)},a=[function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("span",{staticClass:"icon is-small"},[t("i",{staticClass:"fas fa-plus"})])}],i=(t("7f7f"),t("6b54"),t("96cf"),t("3040")),o=t("74ec"),r=new o["a"],l=[],c=[],u={created:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.BUSINESS=JSON.parse(localStorage.getItem("objsession")).business,e.next=3,r.getBusinessPersons({business:this.BUSINESS});case 3:return this.usersData=e.sent,e.next=6,r.getBusinessPersonRequests({business:this.BUSINESS});case 6:return this.usersReqData=e.sent,e.next=9,r.getRoles();case 9:return this.roles=e.sent,e.next=12,r.getPersons();case 12:this.persons=e.sent;case 13:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),data:function(){return{BUSINESS:null,roles:[],persons:[],usersData:l,usersReqData:c,defaultOpenedDetails:[0],name:"",selected:null,model:{email:"",role:"5676081265"}}},computed:{filteredDataArray:function(){var e=this;if(void 0!=this.persons)return this.persons.filter(function(s){return s.name.toString().toLowerCase().indexOf(e.name.toLowerCase())>=0})}},methods:{addUser:function(){var e=this;if(null!=this.selected){var s={businessId:this.BUSINESS.id,roleId:this.model.role,personId:this.selected.id};r.linkPersonToBusiness(s).then(function(s){e.$toast.open({message:"You have added an user to your business!",type:"is-success"});var t=e;r.getBusinessPersons({business:e.BUSINESS}).then(function(e){return t.usersData=e})}).catch(function(s){e.$toast.open({duration:3e3,message:"Something's not good, try again",position:"is-top",type:"is-danger"})})}else this.$toast.open({duration:3e3,message:"Please select a user!",position:"is-top",type:"is-danger"})},deleteUser:function(e){var s=this;r.deleteGraphEdge(e).then(function(e){s.$toast.open({message:"You have deleted the user!",type:"is-success"});var t=s;r.getBusinessPersons({business:s.BUSINESS}).then(function(e){return t.usersData=e})})},aceptUserRequest:function(e){var s=this,t={businessId:e.business.id,personId:e.person.id,roleId:e.role.id};r.linkPersonToBusiness(t).then(function(t){s.$toast.open({message:"You have accepted the user request!",type:"is-success"});var n=s;r.deleteGraphEdge(e.id).then(function(e){var t=s;r.getBusinessPersonRequests({business:s.BUSINESS}).then(function(e){return t.usersReqData=e})}),r.getBusinessPersons({business:s.BUSINESS}).then(function(e){return n.usersData=e})}).catch(function(e){s.$toast.open({duration:3e3,message:"Something's not good, try again",position:"is-top",type:"is-danger"})})},ignoreUserRequest:function(e){var s=this;r.deleteGraphEdge(e).then(function(e){s.$toast.open({message:"You have ignored the user request!",type:"is-success"});var t=s;r.getBusinessPersonRequests({business:s.BUSINESS}).then(function(e){return t.usersReqData=e})})}}},d=u,p=t("2877"),f=Object(p["a"])(d,n,a,!1,null,null,null);f.options.__file="ManageUsers.vue";s["default"]=f.exports}}]);
//# sourceMappingURL=chunk-adc287d2.008ba24f.js.map